# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ: –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

    git clone https://github.com/Zverik/bot_na_rayone.git

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ —Ç–æ–∂–µ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–µ–Ω: —Å–¥–µ–ª–∞–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ virtualenv
–ø—Ä–∏–≤—ã—á–Ω—ã–º –≤–∞–º —Å–ø–æ—Å–æ–±–æ–º. –ù–∞–ø—Ä–∏–º–µ—Ä:

* `python3 -m venv venv`
* `pipenv install`
* `hatch env na_rayone`

–ò –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å `pip` –∏–∑ —ç—Ç–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

    pip install -r requirements.txt
    pip install -r requirements2.txt

–î–∞, –¥–≤–∞ —Å–ø–∏—Å–∫–∞ –æ–¥–∏–Ω –∑–∞ –¥—Ä—É–≥–∏–º. –í—Ç–æ—Ä–æ–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É:
–∞–≤—Ç–æ—Ä —Å–∞–º –∑–∞–ø—É—Ç–∞–ª—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö, –∏ –ø—Ä–æ—â–µ —Å–¥–µ–ª–∞—Ç—å –≥—Ä—è–∑–Ω—ã–π —Ö–∞–∫,
—á–µ–º —á–∏–Ω–∏—Ç—å `setup.py` –∑–∞ –∞–≤—Ç–æ—Ä–æ–º. –î–∞, —Ç–∞–º –º–æ–π —Ñ–æ—Ä–∫, pull requests
welcome.

–í –∫–æ–Ω—Ü–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –∫–æ–º–∞–Ω–¥–æ–π (–∏–∑-–ø–æ–¥ –æ–∫—Ä—É–∂–µ–Ω–∏—è):

    python -m raybot help

### Ansible

–ù–∞ —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ—Ä–∞ –±–æ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ Ansible. –≠—Ç–æ —Ç–∞–∫–∞—è
—á—É–¥–µ—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ —Ñ–∞–π–ª–∞—Ö yaml.
[–í–æ—Ç –∑–¥–µ—Å—å](https://github.com/Zverik/ansible-tile/tree/master/roles/mayak_nav_bot)
–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ —Ä–æ–ª—å –¥–ª—è –±–æ—Ç–∞. –†–æ–ª—å –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ—Ç—Å—è –∏ –º–æ–∂–µ—Ç —Å–ª—É–∂–∏—Ç—å
–ø–æ—à–∞–≥–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –¥–ª—è —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —á–∞—Å—Ç—å –ø—Ä–æ —É—Å—Ç–∞–Ω–æ–≤–∫—É —Å–≤–µ–∂–µ–≥–æ Python: –≤ –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã
–¥–∞—Ç–∞–∫–ª–∞—Å—Å—ã, –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –≤ Python 3.7, –ø–æ—ç—Ç–æ–º—É –≤–µ—Ä—Å–∏–∏ —Å—Ç–∞—Ä–µ–µ —ç—Ç–æ–π –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è.
–≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π –Ω–∞ Ubuntu 18.04, Debian Stretch –∏ CentOS 8.

## –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±–æ—Ç–∞

–ö–∞–∫ –≤—Å–µ–≥–¥–∞, –Ω–æ–≤—ã–π –±–æ—Ç –¥–µ–ª–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ [@BotFather](https://t.me/botfather).
–ü–∏—à–µ—Ç–µ —Ç–∞–º `/newbot` –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç–µ –≤—Å–µ —ç—Ç–∞–ø—ã. –í –∫–æ–Ω—Ü–µ –ø–æ–ª—É—á–∏—Ç–µ –¥–ª–∏–Ω–Ω—É—é
—Å—Ç—Ä–æ–∫—É —Ç–æ–∫–µ–Ω–∞, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å –≤ `config/config.yml` –≤ –ø–æ–ª–µ
`telegram_token`.

–ü–æ–º–∏–º–æ –ø—Ä–æ—á–µ–≥–æ, BotFather –∫–æ–º–∞–Ω–¥–æ–π `/setcommands` –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∞—Ç—å
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∫–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç—É–¥–∞ –≤–æ—Ç —ç—Ç–æ:

```
start - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∫–Ω–æ–ø–∫–∏ –ø–æ–∏—Å–∫–∞
help - –°–ø—Ä–∞–≤–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
popular - –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è
random - –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π
my - –ú–æ–∏ –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è
msg - –ù–∞–ø–∏—Å–∞—Ç—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º
```

## –¢–∞–π–ª—ã

–í –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏ –º—ã –≥–æ—Ç–æ–≤–∏–ª–∏ —Ñ–æ—Ç–æ—á–∫–∏. –ï—Å–ª–∏ –≤—ã –µ—ë –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏, —Ç–æ —Å–¥–µ–ª–∞–π—Ç–µ
–∫–∞—Ç–∞–ª–æ–≥ `photo` –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–∞–ª–æ–≥–∞ —Å –±–æ—Ç–æ–º. –ò–ª–∏ –≥–¥–µ-–Ω–∏–±—É–¥—å –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ, –Ω–æ
—Ç–æ–≥–¥–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –º–æ–∂–µ—Ç —Ç—É–¥–∞ –ø–∏—Å–∞—Ç—å, –∏ –ø—Ä–æ–ø–∏—à–∏—Ç–µ –ø—É—Ç—å –≤ `config.yml`
–≤ –ø–æ–ª–µ `photos`.

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –∫—Ä–æ–º–µ —Ñ–æ—Ç–æ—á–µ–∫, —É –∑–∞–≤–µ–¥–µ–Ω–∏–π –±—ã–ª–∞ –º–∏–Ω–∏-–∫–∞—Ä—Ç–∞, –∏ —Å–ø–∏—Å–∫–∏
–∑–∞–≤–µ–¥–µ–Ω–∏–π —Ç–æ–∂–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–∏ —Å –∫–∞—Ä—Ç–æ–π, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã —Ü–∏—Ñ—Ä—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤,
—Ç–æ –Ω—É–∂–Ω—ã —Ç–∞–π–ª—ã. –¢–∞–π–ª—ã ‚Äî¬†—ç—Ç–æ —Ä–∞—Å—Ç—Ä–æ–≤—ã–µ –∫–≤–∞–¥—Ä–∞—Ç–∏–∫–∏ 256√ó256 —Ç–æ—á–µ–∫, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö
—Å–æ–±—Ä–∞–Ω—ã –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç—ã –Ω–∞ –º–Ω–æ–≥–∏—Ö —Å–∞–π—Ç–∞—Ö, –≤–∫–ª—é—á–∞—è OpenStreetMap. –û–Ω–∏
–ø–æ–¥–µ–ª–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–∏ –º–∞—Å—à—Ç–∞–±–∞, –≥–¥–µ –∫–≤–∞–¥—Ä–∞—Ç–∏–∫ –Ω–∞ –º–∞—Å—à—Ç–∞–±–µ N —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —á–µ—Ç—ã—Ä—ë—Ö
–∫–≤–∞–¥—Ä–∞—Ç–∏–∫–æ–≤ (2√ó2) –º–∞—Å—à—Ç–∞–±–∞ N+1. –í–∞–º –Ω—É–∂–Ω—ã —Ç–∞–π–ª—ã –º–∞—Å—à—Ç–∞–±–æ–≤ 15-17, –∞ —Ç–æ –∏ 14,
–µ—Å–ª–∏ –≥–æ—Ä–æ–¥ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π.

![–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ —Å –∫–∞—Ä—Ç–æ–π](map_example.jpg)

–ï—Å—Ç—å –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ —Ç–∞–π–ª—ã –ø–æ–ª—É—á–∏—Ç—å: —Å–∫–∞—á–∞—Ç—å –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å. –£—á–∏—Ç—ã–≤–∞—è –Ω–µ–±–æ–ª—å—à–æ–π
–æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö (–æ–∫–æ–ª–æ 200 —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ 3 –ú–ë), –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ö–æ—Ä–æ—à–∏. –í—Ç–æ—Ä–æ–π —Ç—Ä–µ–±—É–µ—Ç
—á—É—Ç—å –±–æ–ª—å—à–µ —Ä–∞–±–æ—Ç—ã, –Ω–æ –¥–∞—ë—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∞—Å–∏–≤–µ–µ. –í–∞–∂–Ω–æ, —á—Ç–æ–±—ã –Ω–∞ —Ç–∞–π–ª–∞—Ö –Ω–µ –±—ã–ª–æ
–∑–∞–≤–µ–¥–µ–Ω–∏–π (POI), –Ω–æ –±—ã–ª–∏ –¥–æ—Ä–æ–≥–∏ —Å –∏—Ö –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏, –∑–¥–∞–Ω–∏—è —Å –Ω–æ–º–µ—Ä–∞–º–∏ –∏ –ø–æ–±–æ–ª—å—à–µ
–º–µ—Å—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

–í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Å—ã–ª–æ–∫:

* –°–∫–∞—á–∞—Ç—å –≤—ã–≥—Ä—É–∑–∫—É OpenStreetMap –¥–ª—è —Å–≤–æ–µ–≥–æ –≥–æ—Ä–æ–¥–∞: BBBike, Interline –∏–ª–∏ OSMaxx
  [–∏–∑ —ç—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞](https://wiki.openstreetmap.org/wiki/Processed_data_providers).
* –°—Ç–∏–ª—å [OSM Carto](https://github.com/gravitystorm/openstreetmap-carto/) –≤–∫–ª—é—á–∞–µ—Ç
  –≤ —Å–µ–±—è [–æ–±—Ä–∞–∑ Docker](https://github.com/gravitystorm/openstreetmap-carto/blob/master/DOCKER.md)
  –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ pbf –≤ –±–∞–∑—É PostgreSQL.
* –î–æ–±–∞–≤–∏–≤ –∫ —Ç–æ–º—É –æ–±—Ä–∞–∑—É [Docker –¥–ª—è TileMill](https://github.com/schachmett/docker-tilemill/blob/master/Dockerfile),
  –ø–æ–ª—É—á–∏—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å—Ç–∏–ª–µ–π –Ω–∞ CartoCSS —Å –≤—ã–≥—Ä—É–∑–∫–æ–π –≤ —Ç–∞–π–ª—ã (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:
  `host=db dbname=gis`).
* –£—Å—Ç–∞–Ω–æ–≤–∏–≤ `python3-mapnik` –∏ –ø–∞—Ä—É –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π, –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–π–ª—ã
  –∏–∑ –±–∞–∑—ã PostgreSQL –∏ —Å—Ç–∏–ª—è Mapnik —Å–∫—Ä–∏–ø—Ç–æ–º [polytiles](https://github.com/Zverik/polytiles).
* –ú–æ–∂–Ω–æ –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∫–∞—Ä—Ç—É –≤ QGIS (–∏–ª–∏ –∫—É–ø–∏—Ç—å –æ—Å–Ω–æ–≤—É [—É NextGIS](https://data.nextgis.com/))
  –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å Processing. –í –Ω—ë–º –Ω–∞–π–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É "Generate XYZ tiles (Directory)".

–ï—Å–ª–∏ —Ç–∞–π–ª—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ MBTiles, —Ç–æ [—Ä–∞—Å–ø–∞–∫—É–π—Ç–µ](https://github.com/mapbox/mbtiles-spec/wiki/Implementations)
–∏—Ö –≤ –Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤ `*.png`. –î–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å—Å—è –∫–∞—Ç–∞–ª–æ–≥–∏ —Å —á–∏—Å–ª–æ–≤—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏:
`15`, `16` –∏ `17`. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–∞–ª–æ–≥ `tiles` –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–∞–ª–æ–≥–∞ —Å –±–æ—Ç–æ–º (–∏–ª–∏
–≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ, –ø—Ä–æ–ø–∏—Å–∞–≤ –ø—É—Ç—å –∫ –Ω–µ–º—É –≤ `config.yml` –≤ –ø–æ–ª–µ `tiles`) –∏
–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ —ç—Ç–∏ —á–∏—Å–ª–æ–≤—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏ —Ç—É–¥–∞.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–ë–æ—Ç –æ–∂–∏–¥–∞–µ—Ç –Ω–∞–π—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ yaml –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `config`.

* `config.yml` ‚Äî –º—ã –µ–≥–æ –¥–µ–ª–∞–ª–∏ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. –í–∞–∂–Ω—ã–µ –∫–ª—é—á–∏
  –¥–ª—è –Ω–µ–≥–æ ‚Äî¬†`telegram_token` –∏ `admin_id`, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –∑–∞–ø–æ–ª–Ω–∏–ª–∏ –≤—ã—à–µ.
  –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏, –∫—Ä–æ–º–µ –ø—É—Ç–µ–π, –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ `config.sample.yml`.
  –ü—Ä–æ–ø–∏—à–∏—Ç–µ –ø—É—Ç—å –∫ –ª–æ–≥–∞–º –≤ `logs` (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å!) –∏
  –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –≤–æ–∫—Ä—É–≥ –≤–∞—à–µ–≥–æ —Ä–∞–π–æ–Ω–∞ –≤ `bbox`. –ü–æ—Å–ª–µ–¥–Ω–∏–π –Ω–∞—Ä–∏—Å—É–π—Ç–µ
  –Ω–∞ [—ç—Ç–æ–º —Å–∞–π—Ç–µ](https://boundingbox.klokantech.com/), –≤—ã–±–µ—Ä–∏—Ç–µ
  –≤–Ω–∏–∑—É —Ñ–æ—Ä–º–∞—Ç "CSV" –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —á–∏—Å–ª–∞.
* `responses.yml` ‚Äî –≤—Ç–æ—Ä–æ–π –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª –ø–æ—Å–ª–µ `config.yml`.
  –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ –∏–∑ `responses.sample.yml` –∏ –ø–æ–ø—Ä–∞–≤—å—Ç–µ –ø–æ–ª—è –≤ –Ω—ë–º:
  - `start` –∏ `help`: —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ –∫–æ–º–∞–Ω–¥–∞–º `/start` –∏ `/help`
    —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
  - `buttons`: —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–æ–¥ –ø–æ–ª–µ–º –≤–≤–æ–¥–∞. –¢–æ –µ—Å—Ç—å,
    —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫, –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî¬†—Å–ø–∏—Å–æ–∫ –∫–Ω–æ–ø–æ–∫. –°—Ç—Ä–æ–∫–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö
    –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –ø–æ–∏—Å–∫ –Ω–∞–ø—Ä—è–º—É—é.
  - `synonims`: —Å–ø–∏—Å–æ–∫ —Å–∏–Ω–æ–Ω–∏–º–æ–≤ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤. –ü–æ–º–æ–≥–∞–µ—Ç –¥–µ–ª–∞—Ç—å
    –∫–Ω–æ–ø–∫–∏ –∏–∑ —ç–º–æ–¥–∑–∏, –∞ –Ω–µ –∏–∑ –æ–±—ã—á–Ω—ã—Ö —Å–ª–æ–≤.
  - `responses`: –∑–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç–æ–≤ —Ä–æ–±–æ—Ç—É. –ü–æ–ª–µ `name` –≤—ã–≤–æ–¥–∏—Ç—Å—è
    –∫–∞–∫ –∑–∞–≥–æ–ª–æ–≤–æ–∫, `message` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ–µ –¥–ª–∏–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, `photo`
    —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–º—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏),
    `keywords` (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ) ‚Äî —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤,
    –ø–æ –∫–æ—Ç–æ—Ä—ã–º –≤–µ—Ä–Ω—ë—Ç—Å—è —ç—Ç–æ—Ç –æ—Ç–≤–µ—Ç. –í–∞–∂–Ω–æ, —á—Ç–æ —ç—Ç–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∑–∞—Ç–º–µ–≤–∞—é—Ç
    –≤—Å–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è —Å —Ç–∞–∫–∏–º–∏ –∂–µ —Å–ª–æ–≤–∞–º–∏. –í—Å–µ —Å–ª–æ–≤–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å
    –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ.
  - `skip`: –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –ø–æ–∏—Å–∫–µ.
* `addr.yml` ‚Äî –¥–æ–º–∞, –ø–æ–¥—ä–µ–∑–¥—ã –∏ –Ω–æ–º–µ—Ä–∞ –∫–≤–∞—Ä—Ç–∏—Ä –≤ –Ω–∏—Ö. –≠—Ç–æ—Ç —Ñ–∞–π–ª –æ–ø–∏—Å–∞–Ω
  –≤ [–ø—Ä–æ—à–ª–æ–º —Ä–∞–∑–¥–µ–ª–µ](1-addresses.md).
* `tags.yml` ‚Äî¬†—Ç–µ–≥–∏ OpenStreetMap –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –∏ —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏.
  –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –¥–ª—è –ø–∞–Ω–µ–ª–∏ —Ç–µ–≥–æ–≤ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ. –û–ø–∏—Å–∞–Ω
  –≤ [—Å–ª–µ–¥—É—é—â–µ–º —Ä–∞–∑–¥–µ–ª–µ](3-poi.md).
* `strings.yml` ‚Äî —Å—Ç—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ,
  —Ä–∞–∑–≤–µ —á—Ç–æ –≤—ã –∑–∞—Ö–æ–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –Ω–∞ –¥—Ä—É–≥–æ–π —è–∑—ã–∫. –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å –ø–æ–∫–∞
  –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.

### –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏

–û–±—ã—á–Ω–æ –±–æ—Ç –æ–ø–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–∏—Å–∫–æ–≤–æ–π —Å—Ç—Ä–æ–∫–æ–π: —á–µ–ª–æ–≤–µ–∫ –≤–≤–æ–¥–∏—Ç —Å–ª–æ–≤–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ,
–±–æ—Ç –∏—â–µ—Ç —ç—Ç–∏ —Å–ª–æ–≤–∞ –≤ —Å–≤–æ–∏—Ö –±–∞–∑–∞—Ö. –ü–æ—ç—Ç–æ–º—É –∫–Ω–æ–ø–∫–∏ –ø–æ–¥ –ø–æ–ª–µ–º –≤–≤–æ–¥–∞ —Ä–∞–∑–º–µ—â–µ–Ω—ã
–±–æ–ª—å—à–µ –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–∫–∏: –≤—Å—ë, —á—Ç–æ –æ–Ω–∏ –≤–≤–æ–¥—è—Ç, —á–µ–ª–æ–≤–µ–∫ –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è —Ä–∞–π–æ–Ω–Ω–æ–≥–æ –±–æ—Ç–∞ ‚Äî –∫—É—Ä–∏—Ä—É–µ–º—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∑–∞–≤–µ–¥–µ–Ω–∏–π.
–û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–≥–¥–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π –º–µ–Ω—å—à–µ —Å–æ—Ç–Ω–∏, –∏–ª–∏ –∫–æ–≥–¥–∞ –º—ã —Ö–æ—Ç–∏–º –Ω–µ —Ç–æ–ª—å–∫–æ
–ø–æ–∏—Å–∫, –Ω–æ –∏ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ. –ö–∞—Ç–∞–ª–æ–≥ —Ç–∞–∫–∂–µ –æ–±–ª–µ–≥—á–∞–µ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π:
–∫–æ–≥–¥–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –∏—â–µ—à—å, –≤—Å—ë —Ä–∞–≤–Ω–æ –º–æ–∂–Ω–æ –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è –Ω–∞–∂–∏–º–∞–Ω–∏–µ–º –Ω–∞ –∫–Ω–æ–ø–æ—á–∫–∏.

–ú–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–¥–µ–ª–∞—Ç—å –ø–æ–¥–æ–±–Ω—É—é —Å–∏—Å—Ç–µ–º—É –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö
—Å–ø–∏—Å–∫–æ–≤. –ü–æ–º–∏–º–æ –∫–ª—é—á–µ–π –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ (`name`, `message`, `photo`),
–≤ —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ `responses` –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á `buttons`, —Ñ–æ—Ä–º–∞—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
–∫–æ—Ç–æ—Ä–æ–≥–æ —Ä–æ–≤–Ω–æ —Ç–æ—Ç –∂–µ, —á—Ç–æ —É –æ–±—â–µ–≥–æ `buttons`: —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ —Å—Ç—Ä–æ–∫ –¥–ª—è –≤—ã–≤–æ–¥–∞
–Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ —ç—Ç–∏—Ö —Å—Ç—Ä–æ–∫ –º–æ–≥—É—Ç –≤—Ö–æ–¥–∏—Ç—å –≤ —Å–ø–∏—Å–∫–∏ `keywords` –¥—Ä—É–≥–∏—Ö
–ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤. –ï—Å–ª–∏ –ø–æ–ª—è `buttons` –Ω–µ—Ç, —Ç–æ –≤—ã–≤–æ–¥—è—Ç—Å—è –æ–±—â–∏–µ –∫–Ω–æ–ø–∫–∏.

–ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è `responses` –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–µ–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è
—Ç–µ–≥–æ–≤ –∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π. –¢–æ –µ—Å—Ç—å, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å–ª–æ–≤–∞ –≤—Ä–æ–¥–µ ¬´–µ–¥–∞¬ª
–∏–ª–∏ ¬´—à–∫–æ–ª–∞¬ª. –õ—É—á—à–µ –≤—Å–µ–≥–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å—é –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –≤ `responses`:
–æ–Ω–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ. –¢–æ –µ—Å—Ç—å,
¬´üõí –ú–∞–≥–∞–∑–∏–Ω—ã¬ª –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —Ü–µ–ª–∏–∫–æ–º, –∞ –Ω–µ —Ä–∞–∑–æ–±—å—ë—Ç—Å—è –Ω–∞ –¥–≤–∞ —Å–ª–æ–≤–∞, —ç–º–æ–¥–∑–∏
–∏ ¬´–º–∞–≥–∞–∑–∏–Ω—ã¬ª.

–ù–µ–±–æ–ª—å—à–æ–π –ø—Ä–∏–º–µ—Ä –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫:

```yaml
responses:
  - name: –ß—Ç–æ –∏—â–µ—Ç–µ?
    keywords: [‚¨ÖÔ∏è –Ω–∞—á–∞–ª–æ]
  - name: –ö–∞–∫–∏–µ –º–∞–≥–∞–∑–∏–Ω—ã?
    keywords: [üõí –º–∞–≥–∞–∑–∏–Ω—ã]
    buttons:
      - [‚¨ÖÔ∏è –Ω–∞—á–∞–ª–æ, –ø—Ä–æ–¥—É–∫—Ç—ã, –≤–µ–≥–∞–Ω–∞–º, –∞–ª–∫–æ–≥–æ–ª—å]
      - [–æ–¥–µ–∂–¥–∞, –æ–±—É–≤—å, —Å—É–º–∫–∏, —Ü–≤–µ—Ç—ã]
  - name: –ö–∞–∫–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è?
    keywords: [üçΩÔ∏è –µ–¥–∞]
    buttons:
      - [‚¨ÖÔ∏è –Ω–∞—á–∞–ª–æ, –∫–∞—Ñ–µ, —Ñ–∞—Å—Ç—Ñ—É–¥, –∫–æ—Ñ–µ–π–Ω–∏]
buttons:
  - [üõí –ú–∞–≥–∞–∑–∏–Ω—ã, üçΩÔ∏è –ï–¥–∞, ‚úâÔ∏è –ü–æ—á—Ç–∞]
```

## –ó–∞–ø—É—Å–∫

–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –ø—Ä–æ—Å—Ç–æ: –∏–∑-–ø–æ–¥ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–∞–∫–æ–µ:

    python -m raybot

–ü–æ—è–≤–∏—Ç—Å—è —Å—Ç—Ä–æ—á–∫–∞ –ø—Ä–æ start polling, –∏ –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å —Ç–µ–ª–µ–≥—Ä–∞–º –∏ –Ω–∞–∂–∞—Ç—å
¬´Start¬ª. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –±–æ—Ç—É –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞.
–ï—Å–ª–∏ –æ–±—Ö–æ–¥–∏–ª–∏ –¥–æ–º–∞ –∏ –ø–æ–¥—ä–µ–∑–¥—ã, —Ç–æ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–≤–µ—Å—Ç–∏ —É–ª–∏—Ü—ã –∏ —á–∏—Å–ª–∞.

–£ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ aiogram –µ—Å—Ç—å [—Å—Ç—Ä–∞–Ω–Ω—ã–π –±–∞–≥](https://github.com/aiogram/aiogram/issues/485):
–Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –≤—Ç–æ—Ä–æ–π –æ—Ç–≤–µ—Ç –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –¥–æ –¥–≤—É—Ö –º–∏–Ω—É—Ç.
–í –ø—Ä–æ–¥–µ —ç—Ç–æ–≥–æ —É –º–µ–Ω—è –Ω–µ —Å–ª—É—á–∞–ª–æ—Å—å.

### Systemd

–ù–∞ —Å–µ—Ä–≤–µ—Ä –±–æ—Ç–∞ –ª—É—á—à–µ —Å—Ç–∞–≤–∏—Ç—å –Ω–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
(—ç—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ —Å—Ç—Ä–∞–Ω–Ω–æ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞), –∞ –∫–∞–∫ —Å–µ—Ä–≤–∏—Å systemd. –≠—Ç–æ –Ω–µ—Å–ª–æ–∂–Ω–æ:
—Å–¥–µ–ª–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/systemd/system/nav_bot.service` —Å
[—Ç–∞–∫–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º](https://github.com/Zverik/ansible-tile/blob/master/roles/mayak_nav_bot/files/mayak_nav_bot.service).
–ü–æ–ø—Ä–∞–≤—å—Ç–µ –≤ –Ω—ë–º `User`, `Ground`, `WorkingDirectory` –∏ `ExecStart`.
–î–∞–ª—å—à–µ ‚Äî –∫–∞–∫ –æ–±—ã—á–Ω–æ:

    sudo systemd start nav_bot
    sudo systemd enable nav_bot

–ß—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏, —Å–¥–µ–ª–∞–π—Ç–µ `sudo journalctl -u nav_bot`. –û—Å—Ç–∞–ª—å–Ω—ã–µ
—Ç—Ä–∏ –ª–æ–≥–∞ –±—É–¥—É—Ç –ª–∏–±–æ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –±–æ—Ç–∞, –ª–∏–±–æ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ, –∫–æ—Ç–æ—Ä—ã–π –≤—ã
–ø—Ä–æ–ø–∏—Å–∞–ª–∏ –≤ –∫–ª—é—á–µ `logs` –≤ `config.yml`.

**–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –∑–∞–ø—É—â–µ–Ω –±–æ—Ç –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –µ–≥–æ –æ—Ç–≤–µ—Ç—ã. –ù–æ –±–∞–∑–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø—É—Å—Ç–∞.
–ö–∞–∫ –µ—ë –∑–∞–ø–æ–ª–Ω–∏—Ç—å, —á–∏—Ç–∞–π—Ç–µ –≤ [—Ç—Ä–µ—Ç—å–µ–π —á–∞—Å—Ç–∏](3-poi.md).**
